@model IEnumerable<DDX.OrderManagementSystem.Domain.OrderType>
@{
    ViewBag.Title = "Index";
}
<script src="@Url.Content("~/Scripts/easyUI/datagrid-detailview.js")"></script>
<body class="easyui-layout">
    <script type="text/javascript">
        $(function () {
            $('#dg').datagrid({
                url: '@Url.Action("List", "Order")',
                pageNumber: 1,
                nowrap: false,
                pageSize: 20,
                fit: true,
                queryParams: { "search": "IsStop_ds&0^" },
                toolbar: '#toolbar',
                rownumbers: true,
                pagination: true,
                pageList: [20, 40, 60, 80, 100, 200],
                view: detailview,
                onDblClickRow: function (i, r) {
                    window.open('@Url.Action("Details", "Order")/' + r.Id);
                },
                detailFormatter: function (index, row) {
                    var html = '<div id="ddv-' + index + '" style="padding:5px 0"></div>';
                    html += '<div  style="padding:5px 0"><b>留言:' + row.BuyerMemo + '<br/> 拦截留言：' + row.CutOffMemo + '</b></div>';
                    return html;
                },
                rowStyler: function (index, row) {

                    if (row.IsAllowDelivery == false && row.Status == "已处理") {
                        return 'background-color:#D3D3D3;';
                    }
                },
                onExpandRow: function (index, row) {
                    $('#ddv-' + index).panel({
                        border: false,
                        cache: false,
                        href: '@Url.Action("GetProduct", "OrderProduct")' + "/" + row.Id,
                        onLoad: function () {
                            $('#dg').datagrid('fixDetailRowHeight', index);
                        }
                    });
                    $('#dg').datagrid('fixDetailRowHeight', index);
                }
            });
            $('#area').combobox({
                url: '@Url.Action("GetSearchOptions", "DataDictionaryDetail")/FromArea',
                valueField: 'DicValue',
                textField: 'FullName',
                width: 120,
                panelHeight: 'auto'
            });
            $('#txtNew').combogrid({
                panelWidth: 360,
                idField: 'ECountry',
                textField: 'ECountry',
                url: '/Country/ListALL',
                columns: [[
                    { field: 'CCountry', title: '中文', width: 150 },
                    { field: 'ECountry', title: '英文', width: 100 },
                    { field: 'CountryCode', title: '简码', width: 100 }
                ]]

            });
            $('#cc').combobox({
                panelHeight: 'auto',
                onChange: changeText
            });
            $('#tt').combobox({
                panelHeight: 'auto'
            })
            $('#Platform').combobox({
                url: '/Home/Platform/1',
                valueField: 'id',
                textField: 'text',
                required: true,
                width: 100,
                panelHeight: 'auto',
                onChange: changePlatform
            });
            $('#OrderStatus').combobox({
                url: '/Home/OrderStatus/1',
                valueField: 'id',
                textField: 'text',
                required: true,
                width: 100,
                panelHeight: 'auto'
            });
            $('#IsPrint').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checkPrint,
                width: 100
            });
            $('#IsQue').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checksall,
                width: 100
            });
            $('#IsXu').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checksall,
                width: 100
            });
            $('#IsChai').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checksall,
                width: 100
            });
            $('#IsCanSplit').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checksall,
                width: 100
            });

            $('#IsChong').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checksall,
                width: 100
            });
            $('#IsError').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checksall,
                width: 100
            });
            $('#IsLiu').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checksall,
                width: 100
            });

            $('#IsFba').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checksall,
                width: 100
            });
            $('#OrderPdtType').combobox({
                url: '/Home/OrderPdtType/1',
                valueField: 'id',
                textField: 'text',
                required: true,
                width: 100,
                panelHeight: 'auto'
            });
            $('#orderdateType').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: orderDateType,
                width: 100
            });

            $('#HoldUpType').combobox({
                url: '@Url.Action("GetDataByCode", "Dictionary")/HoldUpType',
                valueField: 'FullName',
                textField: 'FullName',
                panelHeight: 'auto',
                width: 300
            });
            $('#ErrorType').combobox({
                url: '@Url.Action("GetDataByCode", "Dictionary")/ErrorType',
                valueField: 'FullName',
                textField: 'FullName',
                panelHeight: 'auto',
                width: 300
            });

            $('#IsNo').combobox({
                valueField: 0,
                textField: 1,
                panelHeight: 'auto',
                data: checkOrdersAll,
                width: 160,
                onSelect: function (record) {
                    if (record[0] == "ALL")
                        return;
                    var search = "";
                    var a = $('#Account').combobox("getText");
                    if (a != "ALL" && a != "") {
                        search += "Account_es&" + a + "^";
                    }
                    var b = $('#Platform').combobox("getText");
                    if (b != "ALL" && b != "") {
                        search += "Platform_es&" + b + "^";
                    }
                    if (record[0] == 0)
                        search += "IsStop_ds&0^Status_es&已处理^IsOutOfStock_ei&0^CreateOn_et&" + getStartDateTime(1, "d") + "^";;
                    if (record[0] == 1)
                        search = "IsStop_ds&0^Status_es&待包装^IsOutOfStock_ei&0^CreateOn_et&" + getStartDateTime(12, "m") + "^";;
                    if (record[0] == 2)
                        search = "IsStop_ds&0^Status_es&待发货^IsOutOfStock_ei&0^CreateOn_et&" + getStartDateTime(12, "m") + "^";;
                    $("#dg").datagrid("load", {
                        search: search
                    });
                }
            });
            $('#ProductAttribute').combobox({
                url: '@Url.Action("GetSearchOptions", "DataDictionaryDetail")/ProductAttr',
                valueField: 'DicValue',
                textField: 'FullName',
                panelHeight: 'auto'
            });
            $('#FBABy').combobox({
                valueField: 0,
                textField: 1,
              //  panelHeight: 'auto',
                /*   data: [["ALL", "ALL"], ["亚马逊FBA", "FBA"], ["赛兔", "ST"], ["LAI", "LAI"],
                   ["YWRU-AEA", "YWRU-AEA"], ["出口易", "CKY"], ["KS仓库(义乌)", "KS-YW"],
                   ["美东(义乌)", "CA"], ["美东(宁波)", "US-East"], ["KS仓库(宁波)", "KS"],
                   ["(代发)FBA-NB01", "FBA-NB01"], ["(代发)FBA-NB02", "FBA-NB02"], ["(代发)FBA-NB03", "FBA-NB03"], ["(代发)FBA-NB04", "FBA-NB04"],  ["谷仓美东(宁波)", "GCUS-East"]],*/
                data: [["ALL", "ALL"], ["FBA", "FBA"], ["ST", "ST"], ["LAI", "LAI"],
                ["YWRU-AEA", "YWRU-AEA"], ["NBRU-AEA", "NBRU-AEA"], ["CKY", "CKY"], ["KS-YW", "KS-YW"],
                ["CA", "CA"], ["US-East", "US-East"], ["KS", "KS"],
                ["FBA-NB01", "FBA-NB01"], ["FBA-NB02", "FBA-NB02"], ["FBA-NB03", "FBA-NB03"], ["FBA-NB04", "FBA-NB04"], ["FBA-NB05", "FBA-NB05"],
                ["FBA-NB06", "FBA-NB06"], ["FBA-NB07", "FBA-NB07"], ["FBA-NB08", "FBA-NB08"], ["FBA-NB09", "FBA-NB09"], ["GCUS-East", "谷仓美东(宁波)"], ["GCUS-West", "谷仓美西(宁波)"],
                ["YWAZDE", "YWAZDE"], ["UKMAN", "UKMAN"], ["FBA-YWAZUS", "FBA-YWAZUS"], ["FBA-YWAZUS01", "FBA-YWAZUS01"], ["FBA-YWAZUS02", "FBA-YWAZUS02"],
                ["FBA-YWAZUK", "FBA-YWAZUK"], ["FBA-YWAZUK02", "FBA-YWAZUK02"], ["YWGCUS-West", "YWGCUS-West"], ["YWGCUS-East", "YWGCUS-East"], ["YWCA-WEST(DONG)", "YWCA-WEST(DONG)"], ["YWNJ-EAST(LEO)", "YWNJ-EAST(LEO)"], ["FBA-YWAZDE", "FBA-YWAZDE"], ["FBA-YWAZFR", "FBA-YWAZFR"],
                ],
                width: 150
            });

            $('#ProductAttribute').combobox("setValue", "0");
            $('#OrderStatus').combobox("setValue", "ALL");
            $('#IsPrint').combobox("setValue", "ALL");
            $('#orderdateType').combobox("setValue", "CreateOn");
            $('#IsQue').combobox("setValue", "ALL");
            $('#IsXu').combobox("setValue", "ALL");
            $('#IsChai').combobox("setValue", "ALL");
            $('#IsChong').combobox("setValue", "ALL");
            $('#IsError').combobox("setValue", "ALL");
            $('#Platform').combobox("setValue", "ALL");
            $('#IsNo').combobox("setValue", "ALL");
            $('#FBABy').combobox("setValue", "ALL");
            $('#OrderPdtType').combobox("setValue", "ALL");
            $('#CreateOn_st').datebox("setValue", getStartDate(60));
            $('#CreateOn_et').datebox("setValue", getStartDate(-1));
            $('#area').combobox("setValue", "全部");
        });

        //新建
        function c_dlg() {
            var url_str = '@Url.Action("Create", "Order")';
            showdlg(url_str, 'c_dlg', ajaxAdd);
        }
        $('#Platform').combobox({
            url: '/Home/Platform',
            valueField: 'id',
            textField: 'text',
            required: true,
            width: 150,
            panelHeight: 'auto'
        });

        //编辑框
        function e_dlg() {
            var id = getselectedRow();
            if (id != undefined) {
                var url = '@Url.Action("Edit", "Order")/' + id;
                showdlg(url, 'e_dlg', ajaxEdit);
            }
        }
        //异步新建提交
        function ajaxAdd() {
            formPost('c_form', '@Url.Action("Create", "Order")', 'c_dlg', 'dg');
        }
        //异步修改提交
        function ajaxEdit() {
            formPost('e_form', '@Url.Action("Edit", "Order")', 'e_dlg', 'dg');
        }
        //删除
        function del() {
            var id = getselectedRow();
            if (id != undefined) {
                var url = '@Url.Action("Delete", "Order")/' + id;

                delData(url, 'dg', 't');
            }
        }
        //获取选中行
        function getselectedRow() {
            var row = $('#dg').datagrid('getSelected');
            if (row != undefined) {
                if (row.hasOwnProperty('Id')) {
                    var id = row['Id'];
                    return id;
                }
            }
            $.messager.show({
                title: '提示',
                msg: '请选择行',
                timeout: 3000,
                showType: 'slide'
            });
            return (undefined);
        }

        //获取选中行
        function getselectedRowInfo() {
            var row = $('#dg').datagrid('getSelected');
            if (row != undefined) {
                return row;
            }
            $.messager.show({
                title: '提示',
                msg: '请选择行',
                timeout: 3000,
                showType: 'slide'
            });
            return (undefined);
        }

        function getselectedRows(i, b) {
            var s_ids = [];
            var rows = $('#dg').datagrid('getSelections');
            if (rows.length > 0) {
                for (var i = 0; i < rows.length; i++) {
                    s_ids.push(rows[i]["Id"]);
                }
            }
            if (s_ids.length == 0) {
                if (i == 1) {

                } else {
                    if (b) {

                    } else {
                        $.messager.alert("请选择一条数据");
                    }
                }
                return s_ids;
            }
            return s_ids;
        }

        function GetOrder(v, r, i) {
            return v + "<br/>" + r.OrderExNo;
        }

        function GeStatus(v, r, i) {
            var html = v;
            if (r.IsError == 1) {
                html += "(问题订单)";
            }
            if (r.IsAudit == 0) {
                html += "(等待审核)";
            }
            if (r.IsStop == 1) {
                html += "(停售订单)";
            }
            if (r.IsXu == 1) {
                html += "(虚假发货)";
            }
            html += "<br/>";
            if (r.IsPrint >= 1)
                html += "<img src='/Content/imgs/Print.gif'> ";
            if (r.IsMerger == 1)
                html += "<img src='/Content/imgs/Merger.gif'> ";
            if (r.IsSplit == 1)
                html += "<img src='/Content/imgs/Split.gif'> ";
            if (r.IsOutOfStock == 1)
                html += "<img src='/Content/imgs/OutOfStock.gif'> ";
            if (r.IsRepeat == 1)
                html += "<img src='/Content/imgs/Repeat.gif'> ";
            if (r.IsFBA == 1)
                html += " 海外仓:" + r.FBABy;

            return html;
        }

        function GetAmount(v, r, i) {
            var html = v + ":" + r.Amount;
            return html;
        }

        function GetBuyer(v, r, i) {
            var html = "";
            if (r.BuyUnreason > 0) {
                html = "<font color=\"#0000FF\">" + v + "</font><br />" + r.BuyerEmail;
            }
            else {
              html = v + "<br />" + r.BuyerEmail;
            }
            return html;
        }

        function getAccount(v, r, i) {
            var html = v + "<br />" + r.Platform;
            return html;
        }

        function doSearch() {
            search = $('#txtSearch').searchbox("getName") + "&" + $('#txtSearch').searchbox("getValue") + "^IsStop_ds&0^";
            search += $('#txtSearch1').searchbox("getName") + "&" + $('#txtSearch1').searchbox("getValue") + "^IsStop_ds&0^";
            var a = $('#Account').combobox("getText");
            if (a != "ALL" && a != "") {
                search += "Account_es&" + a + "^";
            }
            var b = $('#Platform').combobox("getText");
            if (b != "ALL" && b != "") {
                search += "Platform_es&" + b + "^";
            }
            var c = $('#OrderStatus').combobox("getText");
            if (c != "ALL" && c != "") {
                search += "Status_es&" + c + "^";
            }
            var d = $('#IsPrint').combobox("getValue");
            if (d != "ALL" && d != "" && d != "0") {
                if (d == "1") {
                    search += "IsPrint_ei&0^";
                } else {
                    search += "IsPrint_si&1^";
                }
            }
            var u = $('#IsError').combobox("getValue");
            if (u != "ALL" && u != "" && u != "0") {
                if (u == "1") {
                    search += "IsError_si&1^";
                } else {
                    search += "IsError_ei&0^";
                }
            }
            var t = $('#orderdateType').combobox("getValue");
            var e = $('#CreateOn_st').combobox("getValue");
            if (e != "ALL" && e != "" && e != "0") {
                search += t + "_st&" + e + "^";
            }
            var f = $('#IsFba').combobox("getValue");
            if (f != "ALL" && f != "") {
                search += "IsFBA&" + f + "^";
            }
            var fbay = $('#FBABy').combobox("getValue");
            if (fbay != "ALL" && fbay != "" && fbay != "0") {
                search += "FBABy_es&" + fbay + "^";
            }
            f = $('#CreateOn_et').combobox("getValue");
            if (f != "ALL" && f != "" && f != "0") {
                search += t + "_et&" + f + "^";
            }
            var g = $('#IsQue').combobox("getValue");
            if (g != "ALL" && g != "") {
                if (g == "1") {
                    search += "IsOutOfStock_ds&1^";
                } else {
                    search += "IsOutOfStock_dsi&0^";
                }
            }
            var gg = $('#IsXu').combobox("getValue");
            if (gg != "ALL" && gg != "") {
                if (gg == "1") {
                    search += "IsXu_ds&1^";
                } else {
                    search += "IsXu_dsi&0^";
                }
            }
            var q = $('#IsChai').combobox("getValue");
            if (q != "ALL" && q != "") {
                if (q == "1") {
                    search += "IsSplit_ds&1^";
                } else {
                    search += "IsSplit_ds&0^";
                }
            }
            var IsCanSplit = $('#IsCanSplit').combobox("getValue");
            if (IsCanSplit != "ALL" && IsCanSplit != "") {
                if (IsCanSplit == "1") {
                    search += "IsCanSplit_ds&1^";
                } else {
                    search += "IsCanSplit_ds&0^";
                }
            }
            var w = $('#IsChong').combobox("getValue");
            if (w != "ALL" && w != "") {
                if (w == "1") {
                    search += "IsRepeat_ds&1^";
                } else {
                    search += "IsRepeat_ds&0^";
                }
            }

            var pro = $('#ProductAttribute').combobox("getValue");
            if (pro != "0") {
                search += "ProductAttribute_Product&" + pro + "^";
            }
            var pdttype = $('#OrderPdtType').combobox("getValue");
            if (pdttype != "ALL" && pdttype != "") {
                search += "OrderPdtType&" + pdttype + "^";
            }
            var _area = $('#area').combobox("getText");
            if (_area != "全部" && _area != "") {
                search += "FromArea_ds&" + _area + "^";
            }
            $("#dg").datagrid("load", {
                search: search
            });
        }

        function showPrint() {
            var rows = $('#dg').datagrid('getSelections');
            var ids = [];
            for (var i = 0; i < rows.length; i++) {
                //超过15天未发货且未审批的订单不能打印
                if (rows[i]["IsAllowDelivery"]) {
                    ids.push(rows[i]["OrderNo"]);
                }
                else {
                    alert("订单" + rows[i]["OrderNo"] + "超过规定天数未发货，需要审批！")
                }
                if (rows[i].IsError == 1) {
                    alert("已拦截订单无法打印!");
                    return;
                }
                if (rows[i].TrackCode == "已用完") {
                    alert("跟踪码是已用完的订单无法打印");
                    return;
                }
            }
            if (ids.length > 0) {
                jQuery.ajax({
                    url: "/Home/PostData",
                    type: "post",
                    data: "ids=" + ids.join(','),
                    success: function (sss) {
                        window.open('/Home/PrintSetup/');
                    }
                });
            }
        }
        function showPrintSingle() {
            var rows = $('#dg').datagrid('getSelections');
            var ids = [];
            for (var i = 0; i < rows.length; i++) {
                //超过15天未发货且未审批的订单不能打印
                if (rows[i]["IsAllowDelivery"]) {
                    ids.push(rows[i]["OrderNo"]);
                }
                else {
                    alert("订单" + rows[i]["OrderNo"] + "超过规定天数未发货，需要审批！")
                }
                if (rows[i].IsError == 1) {
                    alert("已拦截订单无法打印!");
                    return;
                }
                if (rows[i].TrackCode == "已用完") {
                    alert("跟踪码是已用完的订单无法打印");
                    return;
                }
            }
            if (ids.length > 0) {
                jQuery.ajax({
                    url: "/Home/PostData",
                    type: "post",
                    data: "ids=" + ids.join(','),
                    success: function (sss) {
                        window.open('/Home/PrintSingleSetup/');
                    }
                });
            }
        }


        function showEdit() {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            $('#s_dlg').show();
            $("#s_dlg").dialog({
                title: '替换',
                modal: true,
                loadingMessage: '正在加载...',
                buttons: [{
                    text: '提交',
                    iconCls: 'icon-ok',
                    handler: function () {
                        jQuery.ajax({
                            url: "/Order/EditOrderReplace/",
                            type: "post",
                            data: "ids=" + s_ids.join(',') + "&oldField=" + $('#txtOld').val() + "&newField=" + $('#txtNew').combogrid("getValue") + "&FieldName=" + $('#cc').combobox("getValue"),
                            success: function (res) {
                                if (res.IsError) {
                                    alert(res.Message);
                                }
                                $('#s_dlg').dialog('close');
                                $('#dg').datagrid("reload");
                            }
                        });
                    }
                }, {
                    text: '取消',
                    handler: function () {
                        $('#s_dlg').dialog('close');
                    }
                }]
            }).dialog('open');
        }

        function e_order() {
            var id = getselectedRow();
            if (id != undefined) {
                window.open('@Url.Action("Edit", "Order")/' + id);
        }
    }

    function dispute() {
        var row = $('#dg').datagrid('getSelected');
        if (row != undefined) {
            if (row.hasOwnProperty('OrderNo')) {
                var id = row['Id'];
                if (id != undefined) {
                    var url_str = '@Url.Action("Create1", "Dispute")/' + id;
                        showdlg(url_str, 'c1_dlg', disputeAdd);
                    }
                }
            }
        }

        function disputeAdd() {
            if (validate()) {
                formPost('c1_form', '@Url.Action("Create1", "Dispute")', 'c1_dlg', 'dg');
            }
        }

        function validate() {
            var paypal = $("#c_Paypal").val();
            if (paypal == '') {
                alert("Paypal账号不能为空！");
                return false;
            }
            else
                return true;

        }

        function reSend() {
            //var rows = $('#dg').datagrid('getSelections');
            //if (rows[0].Status == "已发货") {
            //    alert("禁止对已发货订单操作!");
            //    return;
            //}
            var s_ids = getselectedRows(0);
            $.messager.confirm("提示", "确定要重新发货吗？一共是" + s_ids.length + "条订单", function (r) {
                if (r) {
                    jQuery.ajax({
                        url: "/Order/EditReSend",
                        type: "post",
                        data: "o=" + s_ids.join(','),
                        success: function (res) {
                            if (res.IsSuccess == false) {
                                alert(res.Message);
                            }
                            $('#dg').datagrid("reload");
                        }
                    });
                }
            });
        }
        function setUnPrint() {
            var s_ids = getselectedRows(0);
            $.messager.confirm("提示", "确定要设置为未打印吗？一共是" + s_ids.length + "条订单", function (r) {
                if (r) {
                    jQuery.ajax({
                        url: "/Order/EditUnPrint",
                        type: "post",
                        data: "o=" + s_ids.join(','),
                        success: function (res) {
                            if (res.IsError) {
                                alert(res.Message);
                            }
                            $('#dg').datagrid("reload");
                        }
                    });
                }
            });
        }


        function exportZM() {
            var s_ids = getselectedRows(0);
            var search = "";
            search = "p=ALL&aa=ALL&d=" + s_ids.join(',') + "&f=Id&t=0&a=0&st=2013-01-01&et=2013-01-01&c=4";
            var postUrl = "/Order/ExportDown/1";
            jQuery.ajax({
                url: "/Order/ExportOrder/",
                type: "post",
                data: search,
                success: function (sss) {
                    location.href = postUrl;
                }
            });
        }
        function setsub(v) {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;
            jQuery.ajax({
                url: "/Order/GetSUBTrackCode/",
                type: "post",
                data: search,
                success: function (sss) {
                    if (sss.IsSuccess) {

                        alert("成功");
                        $('#dg').datagrid("reload");

                    } else {
                        alert("失败");
                    }


                }
            });
        }
        function getjc() {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",");

            jQuery.ajax({
                url: "/Order/JCLogistics/",
                type: "post",
                data: search,
                success: function (sss) {
                    alert("成功");
                    $('#dg').datagrid("reload");
                }
            });
        }
        function setgjeub() {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",");
            jQuery.ajax({
                url: "/Order/GetEubTtackCode/",
                type: "post",
                data: search,
                success: function (sss) {
                    $('#dg').datagrid("reload");
                    alert("成功");
                }
            });
        }

        function seteub(v) {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;
            jQuery.ajax({
                url: "/Order/SetRUEUB/",
                type: "post",
                data: search,
                success: function (sss) {
                    $('#dg').datagrid("reload");
                    alert("成功");
                }
            });
        }
        function seteub2(v) {
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;
            jQuery.ajax({
                url: "/Order/SetRUEUB2/",
                type: "post",
                data: search,
                success: function (sss) {
                    $('#dg').datagrid("reload");
                    alert("成功");
                }
            });
        }

        function seteub3(v) {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;
            jQuery.ajax({
                url: "/Order/SetRUEUB3/",
                type: "post",
                data: search,
                success: function (sss) {
                    $('#dg').datagrid("reload");
                    alert("成功");
                }
            });
        }

        function seteub4(v) {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;
            jQuery.ajax({
                url: "/Order/SetRUEUB4/",
                type: "post",
                data: search,
                success: function (sss) {
                    $('#dg').datagrid("reload");
                    alert("成功");
                }
            });
        }

        function seteub5(v) {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;
            jQuery.ajax({
                url: "/Order/SetRUEUB5/",
                type: "post",
                data: search,
                success: function (sss) {
                    $('#dg').datagrid("reload");
                    alert("成功");
                }
            });
        }
        var isLian = 0;
        function setAliSend() {
            //var row = getselectedRowInfo();
            var s_ids = getselectedRows(0);
            var search = "ids=" + s_ids + "&l=" + $('#aliWarehouseCarrierService').combobox("getValue");
            //url = "/Order/SetAliSend/";
            //if (isLian == 2)
            url = "/Order/SetAliSend/";
            jQuery.ajax({
                url: url,
                type: "post",
                data: search,
                success: function (sss) {
                    $('#dg').datagrid("reload");
                    alert("成功");
                }
            });
            $('#dlgAliSend').dialog('close');

        }

        function getaliTrackCode(v) {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            url = "/Order/GetAliTrackCode/";
            if (v == 2) {
                url = "/Order/SetAliSendOver/";
            }
            var s_ids = getselectedRows(0);
            jQuery.ajax({
                url: url,
                type: "post",
                data: "ids=" + s_ids,
                success: function (sss) {
                    alert("成功！");
                    $('#dg').datagrid("reload");
                }
            });
        }
        function createWuyouOrder(v)
        {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var type = "CAINIAO_STANDARD";
            url = "/Order/createWuyouOrder/";
            if (v == 2) {
                url = "/Order/createWuyouOrder/";
                type = "CAINIAO_STANDARD_E";
            }
            var s_ids = getselectedRows(0);
            jQuery.ajax({
                url: url,
                type: "post",
                data: "ids=" + s_ids+"&type="+type,
                success: function (sss) {
                    if (!sss.IsSuccess) {
                        alert(sss.errorinfo);
                        $('#dg').datagrid("reload");
                    }
                    else {
                        alert("成功！");
                        $('#dg').datagrid("reload");
                    }
                  
                }
            });
        }
        function setAliSendShow() {

            var row = getselectedRowInfo();
            if (row) {

                $('#dlgAliSend').dialog('open');
                $("#txtAliOrderNo").val(row["OrderExNo"]);

                $('#aliWarehouseCarrierService').combobox({
                    url: '@Url.Action("GetAliLogistics", "Order")/' + row["Id"],
                valueField: 'Id',
                textField: 'Text',
                panelHeight: '300',
                width: 300
            });
        }
        else {
            alert("请选择一行");
        }
    }


    function GetESTTrackCode() {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        if (s_ids.length == 0) {
            return;
        }
        search = "ids=" + s_ids.join(",");

        jQuery.ajax({
            url: "/Order/GetESTTrackCode/",
            type: "post",
            data: search,
            success: function (sss) {

                alert("成功！");
                $('#dg').datagrid("reload");

            }
        });
    }


    function getgjeubpdf() {
        var s_ids = getselectedRows(0);
        var search = "";
        if (s_ids.length == 0) {
            return;
        }
        search = "ids=" + s_ids.join(",");
        jQuery.ajax({
            url: "/Order/GetGJEubPDF/",
            type: "post",
            data: search,
            success: function (sss) {
                //   alert("成功！");
                // $('#dg').datagrid("reload");
                window.open("/Home/GetDPF");
            }
        });


    }

    function setyw(v) {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;
        jQuery.ajax({
            url: "/Order/GetYWTrackCode/",
            type: "post",
            data: search,
            success: function (sss) {
                if (sss.IsSuccess) {
                    alert("成功");
                    $('#dg').datagrid("reload");

                } else {
                    alert("失败");
                }


            }
        });
    }

    function setyw1(v) {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;
        jQuery.ajax({
            url: "/Order/GetYWTrackCode1/",
            type: "post",
            data: search,
            success: function (sss) {
                if (sss.IsSuccess) {
                    alert("成功");
                    $('#dg').datagrid("reload");

                } else {
                    alert("失败");
                }


            }
        });
    }

    function getWishMail(v) {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;
        jQuery.ajax({
            url: "/Order/GetWishMailTrackCode/",
            type: "post",
            data: search,
            success: function (sss) {
                if (sss.IsSuccess) {
                    alert("成功");
                    $('#dg').datagrid("reload");

                } else {
                    alert("失败");
                }
            }
        });
    }
    function getYWWishMail(v) {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;
        jQuery.ajax({
            url: "/Order/GetYWWishMailTrackCode/",
            type: "post",
            data: search,
            success: function (sss) {
                if (sss.IsSuccess) {
                    alert("成功");
                    $('#dg').datagrid("reload");

                } else {
                    alert("失败");
                }
            }
        });
    }
    function getLazada(v) {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;
        jQuery.ajax({
            url: "/Order/GetLazadaTrackCode/",
            type: "post",
            data: search,
            success: function (sss) {
                if (sss.IsSuccess) {
                    alert("成功");
                    $('#dg').datagrid("reload");

                } else {
                    alert("失败");
                }
            }
        });
    }
    function getWishMailPdf(v) {
        var rows = $('#dg').datagrid('getSelections');
        var ids = [];
        for (var i = 0; i < rows.length; i++) {
            ids.push(rows[i]["TrackCode"]);
        }
        if (ids.length == 0) {
            $.messager.alert("请选择一条数据");
            return;
        }
        var search = "";
        search = "t=" + ids.join(',') + "&p=" + v;
        jQuery.ajax({
            url: "/Order/GetWishMailPDF/",
            type: "post",
            data: search,
            success: function (sss) {
                window.open(sss.url);
            }
        });
    }
    function getYWWishMailPdf(v) {
        var rows = $('#dg').datagrid('getSelections');
        var ids = [];
        var ids1 = [];
        for (var i = 0; i < rows.length; i++) {
            ids.push(rows[i]["Id"]);
            ids1.push(rows[i]["TrackCode"]);
        }
        if (ids.length == 0) {
            $.messager.alert("请选择一条数据");
            return;
        }
        var search = "";
        search = "t=" + ids.join(',') + "&p=" + v + "&tt=" + ids1.join(',');
        jQuery.ajax({
            url: "/Order/GetYWWishMailPDF/",
            type: "post",
            data: search,
            success: function (sss) {
                window.open(sss.url);
            }
        });
    }

    function getywpdf(v) {

        var rows = $('#dg').datagrid('getSelections');
        var ids = [];
        for (var i = 0; i < rows.length; i++) {
            ids.push(rows[i]["TrackCode"]);
        }
        if (ids.length == 0) {
            $.messager.alert("请选择一条数据");
            return;
        }
        var search = "";
        search = "t=" + ids.join(',') + "&p=" + v;
        jQuery.ajax({
            url: "/Order/GetYWPDF/",
            type: "post",
            data: search,
            success: function (sss) {
                window.open("/Home/GetDPF");
            }
        });
    }
    function getywpdf1(v) {

        var rows = $('#dg').datagrid('getSelections');
        var ids = [];
        for (var i = 0; i < rows.length; i++) {
            ids.push(rows[i]["TrackCode"]);
        }
        if (ids.length == 0) {
            $.messager.alert("请选择一条数据");
            return;
        }
        var search = "";
        search = "t=" + ids.join(',') + "&p=" + v;
        jQuery.ajax({
            url: "/Order/GetYWPDF1/",
            type: "post",
            data: search,
            success: function (sss) {
                window.open("/Home/GetDPF");
            }
        });
    }
    function getywpdf2(v) {

        var rows = $('#dg').datagrid('getSelections');
        var ids = [];
        for (var i = 0; i < rows.length; i++) {
            ids.push(rows[i]["TrackCode"]);
        }
        if (ids.length == 0) {
            $.messager.alert("请选择一条数据");
            return;
        }
        var search = "";
        search = "t=" + ids.join(',') + "&p=" + v;
        jQuery.ajax({
            url: "/Order/GetYWPDF2/",
            type: "post",
            data: search,
            success: function (sss) {
                window.open("/Home/GetDPF");
            }
        });
    }

    function setbls() {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",");
        jQuery.ajax({
            url: "/Order/GetBLSTrackCode/",
            type: "post",
            data: search,
            success: function (sss) {
                if (sss.IsSuccess) {

                    alert("成功");
                    $('#dg').datagrid("reload");

                } else {
                    alert("失败");
                }


            }
        });
    }

    function getblspdf() {
        var row = $('#dg').datagrid('getSelected');
        if (row == undefined) {
            $.messager.alert("请选择一条数据");
        }
        var search = "";

        search = "t=" + row["TrackCode"];
        jQuery.ajax({
            url: "/Order/GetBLSPDF/",
            type: "post",
            data: search,
            success: function (sss) {
                if (sss.IsSuccess) {
                    window.open(sss.f);
                }
            }
        });
    }

    function getchukouTrackcode(v) {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;

        jQuery.ajax({
            url: "/Order/GetChuKouLogistics/",
            type: "post",
            data: search,
            success: function (sss) {

                $('#dg').datagrid("reload");
            }
        });
    }
    function setCNE(v) {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;
        jQuery.ajax({
            url: "/Order/GetCNETrackCode/",
            type: "post",
            data: search,
            success: function (sss) {
                if (sss.IsSuccess) {
                    alert("成功");
                    $('#dg').datagrid("reload");

                } else {
                    alert("失败");
                }


            }
        });
    }


    function getcnepdf() {
        var s_ids = [];
        var s_ids1 = [];
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {
            s_ids.push(rows[i]["Id"]);
            s_ids1.push(rows[i]["TrackCode"]);
        }
        if (s_ids.length == 0) {
            $.messager.alert("请选择一条数据");
            return;
        }
        var search = "";

        search = "ids=" + s_ids.join(',') + "&ids1=" + s_ids1.join(',');
        jQuery.ajax({
            url: "/Order/GetCNEPDF/",
            type: "post",
            data: search,
            success: function (sss) {
                if (sss.IsSuccess) {
                    window.open(sss.f);
                }
            }
        });
    }

    function getchukouTrackcode2() {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",");

        jQuery.ajax({
            url: "/Order/GetChuKouTrackCode/",
            type: "post",
            data: search,
            success: function (sss) {
                $('#dg').datagrid("reload");
            }
        });
    }

    function getchukouTrackcode3() {
        var url = "http://api.chukou1.cn/v3/direct-express/package/print-label?";
        url += "token=1C1D66499731BFBD08EDD36BFC04DF3D&user_key=kuf8dn5u9c&format=classic_label&content=address_costoms_split";
        var rows = $('#dg').datagrid('getSelections');
        if (rows.length == 0) {
            alert("请选择一行");
            return;
        }
        debugger;
        for (var i = 0; i < rows.length; i++) {
            url += "&track_no=" + rows[i]["TrackCode"];
        }
        window.open(url);
    }



    function geteubpdf(v) {
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;


        jQuery.ajax({
            url: "/Order/GetEubPdf/",
            type: "post",
            data: search,
            success: function (sss) {

                window.open(sss);

            }
        });
    }

    function geteubpdf1(v) {
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;


        jQuery.ajax({
            url: "/Order/GetEubPdf1/",
            type: "post",
            data: search,
            success: function (sss) {

                window.open(sss);

            }
        });
    }

    function geteubpdf3(v) {
        var s_ids = getselectedRows(0);
        var search = "";
        search = "ids=" + s_ids.join(",") + "&t=" + v;


        jQuery.ajax({
            url: "/Order/GetEubPdf3/",
            type: "post",
            data: search,
            success: function (sss) {

                window.open(sss);

            }
        });
    }
    function getalipdf() {

        var s_ids = getselectedRows(0);

        location.href = "/Order/GetAliPDF/" + encodeURIComponent(s_ids);

    }


    function ExportExcel(t) {
        var s_ids = getselectedRows(0);
        var search = "";
        search = "p=ALL&aa=ALL&d=" + s_ids.join(',') + "&f=Id&t=0&a=0&st=2013-01-01&et=2013-01-01&c=" + t;
        var postUrl = "/Order/ExportDown/1";
        jQuery.ajax({
            url: "/Order/ExportOrder/",
            type: "post",
            data: search,
            success: function (sss) {
                location.href = postUrl;
            }
        });
    }

    function stopLoad() {
        $('#dg').datagrid("reload");
    }

    function exportOrder(v) {
        var s_ids = getselectedRows(1);
        var search = "";
        if (s_ids.length == 0) {
            /*var e = $('#CreateOn_st').combobox("getValue");
            if (e != "ALL" && e != "" && e != "0") {
                search += "&st=" + e + "";
            } else {
                alert("请选择开始时间！");
                stopLoad(); return;
            }
            var f = $('#CreateOn_et').combobox("getValue");
            if (f != "ALL" && f != "" && f != "0") {
                search += "&et=" + f + "";
            } else {
                alert("请选择结束时间！"); stopLoad(); return;
            }
            var c = $('#OrderStatus').combobox("getText");
            if (c != "") {
                if (c != "ALL")
                    search += "&s=" + c + "";
            } else {
                alert("请选择订单状态！"); stopLoad(); return;
            }
            var a = $('#Account').combobox("getText");
            if (a != "ALL" && a != "") {
                search += "&a=" + a + "";
            } else {
                // alert("请选择账户！"); stopLoad(); return;
            }
            var b = $('#Platform').combobox("getText");
            if (b != "ALL" && b != "") {
                search += "&p=" + b + "";
            } else {
                //alert("请选择平台！"); stopLoad(); return;
            }
            if (search.length == 0) {
                alert("不选订单，也选个时间啊！");
                stopLoad(); return;
            }*/
            search = $('#txtSearch').searchbox("getName") + "=" +$('#txtSearch').searchbox("getValue") + "^IsStop_ds=0^";
            search += $('#txtSearch1').searchbox("getName") + "=" +$('#txtSearch1').searchbox("getValue") + "^IsStop_ds=0^";
            var a = $('#Account').combobox("getText");
            if (a != "ALL" && a != "") {
                search += "Account_es=" + a + "^";
            }
            var b = $('#Platform').combobox("getText");
            if (b != "ALL" && b != "") {
                search += "Platform_es=" + b + "^";
            }
            var c = $('#OrderStatus').combobox("getText");
            if (c != "ALL" && c != "") {
                search += "Status_es=" + c + "^";
            }
            var d = $('#IsPrint').combobox("getValue");
            if (d != "ALL" && d != "" && d != "0") {
                if (d == "1") {
                    search += "IsPrint_ei=0^";
                } else {
                    search += "IsPrint_si=1^";
                }
            }
            var u = $('#IsError').combobox("getValue");
            if (u != "ALL" && u != "" && u != "0") {
                if (u == "1") {
                    search += "IsError_si=1^";
                } else {
                    search += "IsError_ei=0^";
                }
            }
            var t = $('#orderdateType').combobox("getValue");
            var e = $('#CreateOn_st').combobox("getValue");
            if (e != "ALL" && e != "" && e != "0") {
                search += t + "_st=" + e + "^";
            }
            var f = $('#IsFba').combobox("getValue");
            if (f != "ALL" && f != "" && f != "0") {
                search += "IsFBA=" + f + "^";
            }
            var fbay = $('#FBABy').combobox("getValue");
            if (fbay != "ALL" && fbay != "" && fbay != "0") {
                search += "FBABy=" + fbay + "^";
            }
            f = $('#CreateOn_et').combobox("getValue");
            if (f != "ALL" && f != "" && f != "0") {
                search += t + "_et=" + f + "^";
            }
            var g = $('#IsQue').combobox("getValue");
            if (g != "ALL" && g != "") {
                if (g == "1") {
                    search += "IsOutOfStock_ds=1^";
                } else {
                    search += "IsOutOfStock_dsi=0^";
                }
            }
            var gg = $('#IsXu').combobox("getValue");
            if (gg != "ALL" && gg != "") {
                if (gg == "1") {
                    search += "IsXu_ds=1^";
                } else {
                    search += "IsXu_dsi=0^";
                }
            }
            var q = $('#IsChai').combobox("getValue");
            if (q != "ALL" && q != "") {
                if (q == "1") {
                    search += "IsSplit_ds=1^";
                } else {
                    search += "IsSplit_ds=0^";
                }
            }
            var IsCanSplit = $('#IsCanSplit').combobox("getValue");
            if (IsCanSplit != "ALL" && IsCanSplit != "") {
                if (IsCanSplit == "1") {
                    search += "IsCanSplit_ds=1^";
                } else {
                    search += "IsCanSplit_ds=0^";
                }
            }
            var w = $('#IsChong').combobox("getValue");
            if (w != "ALL" && w != "") {
                if (w == "1") {
                    search += "IsRepeat_ds=1^";
                } else {
                    search += "IsRepeat_ds=0^";
                }
            }

            var pro = $('#ProductAttribute').combobox("getValue");
            if (pro != "0") {
                search += "ProductAttribute_Product=" + pro + "^";
            }
            var pdttype = $('#OrderPdtType').combobox("getValue");
            if (pdttype != "ALL" && pdttype != "") {
                search += "OrderPdtType=" + pdttype + "^";
            }
            var _area = $('#area').combobox("getText");
            if (_area != "全部" && _area != "") {
                search += "FromArea_ds=" + _area + "^";
            }
        }
        var t = $('#orderdateType').combobox("getValue");
        var postUrl = "/Order/ExportDown/1";
        //if (v == 0) {
            jQuery.ajax({
                url: "/Order/ExportOrder3/",
                type: "post",
                data: "o=" + s_ids.join(',') +"&search=" +search + "" + "&dd=" + t + "&c=" +v,
                success: function (res) {
                    if (res.IsError) {
                        alert(res.Message);
                    }
                    location.href = postUrl;

                }
            });
        //}
        //else {
        //    jQuery.ajax({
        //        url: "/Order/ExportOrder3/",
        //        type: "post",
        //        data: "o=" + s_ids.join(',') + "&search=" + search + "" + "&dd=" + t + "&c=1",
        //        success: function (res) {
        //            if (res.IsError) {
        //                alert(res.Message);
        //            }
        //            location.href = postUrl;

        //        }
        //    });
        //}
    }

    function o_Error() {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        $.messager.confirm("提示", "确定要作废这" + s_ids.length + "条订单吗？", function (r) {
            if (r) {
                jQuery.ajax({
                    url: "/Order/EditOrderProperty",
                    type: "post",
                    data: "o=" + s_ids.join(',') + "&t=3" + "&c=" + $("#ErrorType").combobox("getValue") + " " + $("#ErrorDesc").val(),
                    success: function (res) {
                        if (res.IsError) {
                            alert(res.Message);
                        }
                        $('#dg').datagrid("reload");
                        $('#dlgError').dialog('close');
                    }
                });
            }
        });
    }

    function o_ReQue(parameters) {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        $.messager.confirm("提示", "确定要修正这" + s_ids.length + "条订单吗？", function (r) {
            if (r) {
                jQuery.ajax({
                    url: "/Order/EditOrderProperty/",
                    type: "post",
                    data: "o=" + s_ids.join(',') + "&t=1",
                    success: function (res) {
                        if (res.IsError) {
                            alert(res.Message);
                        }
                        $('#dg').datagrid("reload");
                    }
                });
            }
        });

    }
        //缺货订单重新计算
    function CalculateQue()
    {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        $.messager.confirm("提示", "确定要重新计算这" + s_ids.length + "条订单缺货状态吗？", function (r) {
            if (r) {
                jQuery.ajax({
                    url: "/Order/CalculateQue/",
                    type: "post",
                    data: "ids=" + s_ids.join(',') ,
                    success: function (res) {
                        if (res.IsError) {
                            alert(res.Message);
                        }
                        $('#dg').datagrid("reload");
                    }
                });
            }
        });

    }
    function o_ReError() {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货" && rows[i].IsXu == 0) {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        $.messager.confirm("提示", "确定要修正这" + s_ids.length + "条订单吗？", function (r) {
            if (r) {
                jQuery.ajax({
                    url: "/Order/EditOrderProperty/",
                    type: "post",
                    data: "o=" + s_ids.join(',') + "&t=2",
                    success: function (res) {
                        if (res.IsError) {
                            alert(res.Message);
                        }
                        $('#dg').datagrid("reload");
                    }
                });
            }
        });
    }

    function o_SplitZu() {
        var rows = $('#dg').datagrid('getSelections');
        var s_ids = getselectedRows(0);
        $.messager.confirm("提示", "检验可能有组合产品的" + s_ids.length + "条订单吗？", function (r) {
            if (r) {
                jQuery.ajax({
                    url: "/Order/EditSplitZu/",
                    type: "post",
                    data: "o=" + s_ids.join(','),
                    success: function (res) {
                        if (res.IsError) {
                            alert(res.Message);
                        }
                        $('#dg').datagrid("reload");
                    }
                });
            }
        });
    }

    function changePlatform(n, o) {
        $('#Account').combotree({
            url: '/Home/AccountList/' + n,
            valueField: 'id',
            textField: 'text',
            required: true,
            width: 150
        });
    }
    function getOrderDate(v, r, i) {
        var html = "";
        html += "下:<b>" + getDate(r.GenerateOn) + "</b><br/>";
        html += "同:<b>" + getDate(r.CreateOn) + "</b>";
        if (r.Status == "已发货")
            html += "<br/>扫:" + getDate(r.ScanningOn);
        return html;
    }

    function getDateinfo(v, r, i) {
        if (v) {
            return getDate(v);
        }
    }
    function o_LanJie() {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        $.messager.confirm("提示", "你要拦截 " + s_ids.length + "条订单吗？", function (r) {
            if (r) {
                jQuery.ajax({
                    url: "/Order/EditOrderHoldUp/",
                    type: "post",
                    data: "o=" + s_ids.join(',') + "&t=" + $("#HoldUpType").combobox("getValue") + "&d=" + $("#HoldUpDesc").val() + "&s=" + $("#CReHoldUp").val(),
                    success: function (res) {
                        if (res.IsError) {
                            alert(res.Message);
                        }
                        $('#dg').datagrid("reload");
                    }
                });
            }
        });
    }

    function oneKeySplitOrder() {
        var rows = $('#dg').datagrid('getSelections');
        for (var i = 0; i < rows.length; i++) {//循环数组
            if (rows[i].Status == "已发货") {
                alert("禁止对已发货订单操作!");
                return;
            }
        }
        var s_ids = getselectedRows(0);
        $.messager.confirm("提示", "你要一键拆分这" + s_ids.length + "条订单吗？", function (r) {
            if (r) {
                jQuery.ajax({
                    url: "/Order/EditOneKeySplitOrder/",
                    type: "post",
                    data: "o=" + s_ids.join(','),
                    success: function (res) {
                        window.open('@Url.Action("Result", "Home")');
                        $('#dg').datagrid("reload");
                    }
                });
                }
        });
        }

        function GetTrackCode(v, r, i) {
            var html = "";
            if (r.TrackCode2.length == 0) {
                html += "假：" + r.TrackCode2 + "<br />";
            }
            html += "真：" + r.TrackCode + "";
            return html;
        }
        function kuai(v) {
            if (v == 1) {
                name = "IsPrint";
            }
            if (v == 2) {
                name = "IsMerger";
            }
            if (v == 3) {
                name = "IsSplit";
            }
            if (v == 4) {
                name = "IsOutOfStock";
            }
            if (v == 5) {
                name = "IsRepeat";
            }
            var search = name + "_si&1^IsStop_ds&0^";
            var e = $('#CreateOn_st').datebox("getValue");
            if (e != "ALL" && e != "" && e != "0") {
                search += "CreateOn_st&" + e + "^";
            }
            var f = $('#CreateOn_et').datebox("getValue");
            if (f != "ALL" && f != "" && f != "0") {
                search += "CreateOn_et&" + f + "^";
            }
            $("#dg").datagrid("load", {
                search: search
            });
        }
        function selectlist(v) {
            if (v == "ALL") {
                $("#dg").datagrid("load", {
                    search: ""
                });
            }
            if (v == '退货订单' || v == '待处理' || v == '已处理' || v == '待拣货' || v == '待包装' || v == '待发货' || v == '已发货' || v == '已完成' || v == '作废订单') {
                $('#OrderStatus').combobox("setValue", v);
                $("#dg").datagrid("load", {
                    search: "IsAudit_ds&1^IsStop_ds&0^Status_es&" + v
                });
            }
            if (v == '缺货订单') {
                $("#dg").datagrid("load", {
                    search: "IsStop_ds&0^IsOutOfStock_ds&1^Status_un&作废订单^"
                });
                $('#IsQue').combobox("setValue", "1");
            }
            if (v == '停售订单') {
                $("#dg").datagrid("load", {
                    search: "IsStop_ds&1^Status_un&作废订单^"
                });
                $('#OrderStatus').combobox("setValue", "ALL");
            }
            if (v == '等待审核') {
                $("#dg").datagrid("load", {
                    search: "IsAudit_ds&0^"
                });

            }
        }

        function xuSend() {
            /*var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }*/
            var s_ids = getselectedRows(0);
            $.messager.confirm("提示", "确定要把这些订单在平台上单号上传吗？", function (r) {
                if (r) {
                    jQuery.ajax({
                        url: "/Order/XuSend/",
                        type: "post",
                        data: "ids=" + s_ids.join(','),
                        success: function (res) {
                            if (!res.IsSuccess) {
                                alert("成功！");
                            }
                            $('#dg').datagrid("reload");
                        }
                    });
                }
            });

        } 
        function GCxusend(v) {
            /*var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }*/
            var s_ids = getselectedRows(0);
            $.messager.confirm("提示", "确定要把这些订单在平台上单号上传吗？", function (r) {
                if (r) {
                    jQuery.ajax({
                        url: "/Order/GCxusend/",
                        type: "post",
                        data: "ids=" + s_ids.join(',') + "&l="+v,
                        success: function (res) {
                            if (!res.IsSuccess) {
                                alert("成功！");
                            }
                            $('#dg').datagrid("reload");
                        }
                    });
                }
            });

        }
        function GetTradeno() {
            var rows = $('#dg').datagrid('getSelections');
           for (var i = 0; i < rows.length; i++) {//循环数组
               if (rows[i].Status == "已发货" || rows[i].Status == "退货订单") {
                   alert("禁止对已发货|退货订单操作!");
                   return;
               }
           }
            var s_ids = getselectedRows(0);
            $.messager.confirm("提示", "确定手动单号自【邮政编码】获取吗？", function (r) {
                if (r) {
                    jQuery.ajax({
                        url: "/Order/GetTradeno/",
                        type: "post",
                        data: "ids=" + s_ids.join(','),
                        success: function (res) {
                            if (!res.IsSuccess) {
                                alert("成功！");
                            }
                            $('#dg').datagrid("reload");
                        }
                    });
                }
            });

        }
        //// 禁止操作已发货订单
        //function ExceptOperation(rows) {
        //    if (rows[0].Status == "已发货") {
        //        alert("禁止对已发货订单操作!");
        //        return;
        //    }
        //    //else {
        //    //    return true;
        //    //}
        //}
        function setstatus() {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            $.messager.confirm("提示", "确定要把这些订单标记为已发货吗？", function (r) {
                if (r) {
                    jQuery.ajax({
                        url: "/Order/setstatus/",
                        type: "post",
                        data: "ids=" + s_ids.join(','),
                        success: function (res) {
                            if (!res.IsSuccess) {
                                alert("成功！");
                            }
                            $('#dg').datagrid("reload");
                        }
                    });
                }
            });

        }
        function showPrintWindow() {
            var rows = $('#dg').datagrid('getSelections');
            if (rows.length == 0) {
                alert("请选择数据");
                return;
            }
            var mm = rows[0].LogisticMode;
            var country = rows[0].Country;
            var ids = [];
            for (var i = 0; i < rows.length; i++) {
                if (mm == rows[i]["LogisticMode"]) {
                    if (rows[i]["IsAllowDelivery"]) {
                        ids.push(rows[i]["OrderNo"]);
                    }
                    else {
                        alert(rows[i]["OrderNo"] + "超过规定天数未发货，需要审批！")
                    }
                    if (rows[i].IsError == 1) {
                        alert("已拦截订单无法打印!");
                        return;
                    }
                    if (rows[i].TrackCode == "已用完")
                    {
                        alert("跟踪码是已用完的订单无法打印");
                        return;
                    }
                }

            }
            if (country == "United States" && mm=="e邮宝（线下）")
            {
                mm="e邮宝（线下）10*10";
            }
            if (country == "United States" && mm == "e邮宝（eBay）") {
                mm = "e邮宝（eBay）10*10";
            }
            $.ajax({
                type: "POST",
                url: "/PrintTemplate/GetTemplateId",
                data: "t=" + mm,
                success: function (temp) {
                    if (temp.IsSuccess == true) {
                        $.ajax({
                            type: "POST",
                            url: "/Home/SetPrintData",
                            data: "ids=" + ids.join(","),
                            success: function (msg) {
                                if (msg.IsSuccess != "") {
                                    $('#printdata').val(msg.Result);
                                    window.open('/Home/PrintDetail/' + temp.Id);
                                }
                            }
                        });
                    }
                }
            });


        }
        function showPrintSingleWindow() {
            var rows = $('#dg').datagrid('getSelections');
            if (rows.length == 0) {
                alert("请选择数据");
                return;
            }
            var mm = rows[0].LogisticMode;
            var country = rows[0].Country;
            var ids = [];
            for (var i = 0; i < rows.length; i++) {
                if (mm == rows[i]["LogisticMode"]) {
                    if (rows[i]["IsAllowDelivery"]) {
                        ids.push(rows[i]["OrderNo"]);
                    }
                    else {
                        alert(rows[i]["OrderNo"] + "超过规定天数未发货，需要审批！")
                    }
                }
                if (rows[i].IsError == 1) {
                    alert("已拦截订单无法打印!");
                    return;
                }
                if (rows[i].TrackCode == "已用完") {
                    alert("跟踪码是已用完的订单无法打印");
                    return;
                }

            }
            if (country == "United States" && mm == "e邮宝（线下）")  {
                mm = "e邮宝（线下）10*10";
            }
            if (country == "United States" && mm == "e邮宝（eBay）") {
                mm = "e邮宝（eBay）10*10";
            }
            $.ajax({
                type: "POST",
                url: "/PrintTemplate/GetTemplateId",
                data: "t=" + mm,
                success: function (temp) {
                    if (temp.IsSuccess == true) {
                        $.ajax({
                            type: "POST",
                            url: "/Home/SetPrintSingleData",
                            data: "ids=" + ids.join(","),
                            success: function (msg) {
                                if (msg.IsSuccess != "") {
                                    $('#printdata').val(msg.Result);
                                    window.open('/Home/PrintDetail/' + temp.Id);
                                }
                            }
                        });
                    }
                }
            });


        }
        function updateOrders() {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            $('#s_dlg').show();
            $('#btnOrderExport').linkbutton('enable');
            $("#s_dlg").dialog({
                title: '替换',
                modal: true,
                width: 400,
                height: 450,
                loadingMessage: '正在加载...',
                buttons: [{
                    text: '提交',
                    id: 'btnSubmit',
                    iconCls: 'icon-ok',
                    handler: function () {
                        s_ids = [];
                        var OrderNos = $('#txtOrderNo').val();
                        s_ids = OrderNos.split('\n');
                        if (s_ids.length > 5000) {
                            alert("最多只能输入5000行！");
                            return false;
                        }
                        for (var i = 0; i < s_ids.length; i++) {
                            s_ids[i] = "'" + s_ids[i] + "'";

                        }
                        if (s_ids == "''") {
                            alert("请输入要替换的订单!")
                            return false;
                        }
                        // 需要输入密码
                        $.messager.prompt('密码验证', '请输入当前操作人密码', function (k) {
                            if (k) {
                                $('#btnSubmit').linkbutton('disable');
                                $('#btnCancel').linkbutton('disable');
                                $('#btnOrderExport').linkbutton('disable');
                                jQuery.ajax({
                                    url: "/Order/CheckPass",
                                    type: "post",
                                    data: "p=" + k,
                                    success: function (rrr) {
                                        if (rrr.IsSuccess) {
                                            $.messager.confirm("提示", "确定要重置这些订单吗？", function (r) {
                                                if (r) {

                                                    jQuery.ajax({
                                                        url: "/Order/EditOrders/",
                                                        type: "post",
                                                        data: "ids=" + s_ids.join(',') + "&FieldType=" + $('#tt').combobox("getValue") + "&newField=" + $('#txtNew').combogrid("getValue") + "&FieldName=" + $('#cc').combobox("getValue"),
                                                        success: function (res) {

                                                            if (res.IsSuccess) {
                                                                alert('批量更新成功！');
                                                                $('#dg').datagrid("reload");
                                                            }
                                                            else {
                                                                alert('批量更新失败！');
                                                            }
                                                            $('#s_dlg').dialog('close');
                                                        }
                                                    });
                                                }
                                            });
                                        } else {
                                            alert(rrr.Msg);
                                        }
                                    }
                                });
                            }
                        });


                    }
                }, {
                    text: '取消',
                    id: 'btnCancel',
                    handler: function () {
                        $('#s_dlg').dialog('close');
                    }
                }]
            }).dialog('open');
        }
        function changeText(n, o) {
            if (n == "Country") {
                $('#txtNew').combogrid({
                    panelWidth: 360,
                    idField: 'ECountry',
                    textField: 'ECountry',
                    url: '/Country/ListALL',

                    columns: [[
                        { field: 'CCountry', title: '中文', width: 150 },
                        { field: 'ECountry', title: '英文', width: 100 },
                        { field: 'CountryCode', title: '简码', width: 100 }
                    ]]

                });
            }
            if (n == "SKU") {
                $('#txtNew').combogrid({
                    panelWidth: 410,
                    mode: 'remote',
                    idField: 'SKU',
                    textField: 'SKU',
                    url: '/Product/ListQ',

                    columns: [[
                        { field: 'SKU', title: 'SKU', width: 100 },
                        { field: 'ProductName', title: 'Title', width: 200 },
                        { field: 'Standard', title: '规格', width: 100 }

                    ]]

                });
            }
            if (n == "LogisticMode") {
                $('#txtNew').combogrid({
                    panelWidth: 360,
                    idField: 'LogisticsCode',
                    textField: 'LogisticsName',
                    url: '/LogisticsMode/ALLList',

                    columns: [[
                        { field: 'LogisticsName', title: '名称', width: 250 },
                        { field: 'LogisticsCode', title: '代码', width: 100 }


                    ]]

                });
            }
            if (n == "CurrencyCode") {
                $('#txtNew').combogrid({
                    panelWidth: 360,
                    idField: 'CurrencyCode',
                    textField: 'CurrencyCode',
                    url: '/Currency/QList',
                    columns: [[
                        { field: 'CurrencyName', title: '货币', width: 150 },
                        { field: 'CurrencyCode', title: '代码', width: 100 },
                        { field: 'CurrencyValue', title: '汇率', width: 100 }
                    ]]
                });
            }
            if (n == "OrderStatusinput") {
                $('#txtNew').combogrid({
                    panelWidth: 150,
                    url: '/Order/GetOrderStatus',
                    idField: 'text',
                    textField: 'text',
                    columns: [[
                        { field: 'text', title: '状态', width: 150 }
                    ]]
                });
            }
        }
        function exportOrderinput() {
            var strtype = $('#tt').combobox('getValue');
            s_ids = [];
            var OrderNos = $('#txtOrderNo').val();
            s_ids = OrderNos.split('\n');
            for (var i = 0; i < s_ids.length; i++) {
                s_ids[i] = "'" + s_ids[i] + "'";

            }
            var postUrl = "/Order/ExportDown/1";
            $.ajax({
                url: '@Url.Action("ExportOrderInput", "Order")/',
                type: 'post',
                data: 'type=' + strtype + '&StrNo=' + s_ids.join(','),
                success: function (result) {
                    location.href = postUrl;

                }
            });
        }
        function auditOders() {
            var rows = $('#dg').datagrid('getSelections');
            if (rows.length == 0) {
                alert("请选择数据");
                return;
            }
            // 需要输入密码
            $.messager.prompt('密码验证', '请输入当前登录主管密码', function (k) {
                if (k) {
                    $('#btnSubmit').linkbutton('disable');
                    $('#btnCancel').linkbutton('disable');
                    $('#btnOrderExport').linkbutton('disable');
                    jQuery.ajax({
                        url: "/WarehouseStock/CheckPassCharge",
                        type: "post",
                        data: "p=" + k,
                        success: function (rrr) {
                            if (rrr.IsSuccess) {
                                $.messager.confirm("提示", "确定要审批通过这些订单吗？", function (r) {
                                    if (r) {
                                        var ids = [];
                                        for (var i = 0; i < rows.length; i++) {
                                            if (!rows[i]["IsAllowDelivery"])
                                                ids.push(rows[i]["OrderNo"]);

                                        }
                                        jQuery.ajax({
                                            url: "/Order/AuditOrders/",
                                            type: "post",
                                            data: "OrderList=" + ids,
                                            success: function (res) {

                                                if (res) {
                                                    alert('批量审批成功！');
                                                    $('#dg').datagrid("reload");
                                                }
                                                else {
                                                    alert('批量审批失败！');
                                                }
                                                $('#s_dlg').dialog('close');
                                            }
                                        });
                                    }
                                });
                            } else {
                                alert(rrr.Msg);
                            }
                        }
                    });
                }
            });


        }

        function getjcpdf() {
            var s_ids = [];
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {
                s_ids.push(rows[i]["Id"]);
            }
            if (s_ids.length == 0) {
                $.messager.alert("请选择一条数据");
                return;
            }
            var search = "";

            search = "ids=" + s_ids.join(',');
            jQuery.ajax({
                url: "/Order/GetJCPDF/",
                type: "post",
                data: search,
                success: function (sss) {
                    if (sss.IsSuccess) {
                        window.open(sss.f);
                    }
                }
            });
        }

        function getMiaoxin() {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",");

            jQuery.ajax({
                url: "/Order/GetMiaoxinTrackCode/",
                type: "post",
                data: search,
                success: function (sss) {

                    $('#dg').datagrid("reload");
                }
            });
        }

        function getMiaoxinPDF(v) {
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;


            jQuery.ajax({
                url: "/Order/GetSHMXPdf/",
                type: "post",
                data: search,
                success: function (sss) {

                    window.open("/Home/GetDPF");

                }
            });
        }
        function getBdt(v) {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;

            jQuery.ajax({
                url: "/Order/GetBdtTrackCode/",
                type: "post",
                data: search,
                success: function (sss) {

                    $('#dg').datagrid("reload");
                }
            });
        }
        function getBdt1(v) {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;

            jQuery.ajax({
                url: "/Order/GetBdtTrackCode1/",
                type: "post",
                data: search,
                success: function (sss) {

                    $('#dg').datagrid("reload");
                }
            });
        }

        function getBdtPDF(v) {
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;


            jQuery.ajax({
                url: "/Order/GetBdtPDF/",
                type: "post",
                data: search,
                success: function (sss) {
                    if (sss.IsSuccess) {
                        window.open(sss.f);
                    }
                }
            });
        }

        function ToGCorder(v) {
            var rows = $('#dg').datagrid('getSelections');

            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;

            jQuery.ajax({
                url: "/Order/ToGCorder/",
                type: "post",
                data: search,
                success: function (sss) {

                    $('#dg').datagrid("reload");
                }
            });
            //  $('#dlgGC_createorder').dialog('close');
        }
        function ToNBGHorder(v)
        {
            var rows = $('#dg').datagrid('getSelections');

            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;

            jQuery.ajax({
                url: "/Order/ToNBGHorder/",
                type: "post",
                data: search,
                success: function (sss) {
                    alert(sss.Msg);
                    $('#dg').datagrid("reload");
                }
            });
        }
        function GetOrderByRefCode(v) {
            var rows = $('#dg').datagrid('getSelections');

            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;

            jQuery.ajax({
                url: "/Order/GetOrderByRefCode/",
                type: "post",
                data: search,
                success: function (sss) {

                    $('#dg').datagrid("reload");
                }
            });
            //  $('#dlgGC_createorder').dialog('close');
        }
        function GetNBGH(v)
        {
            var rows = $('#dg').datagrid('getSelections');

            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;

            jQuery.ajax({
                url: "/Order/GetNBGH/",
                type: "post",
                data: search,
                success: function (sss) {
                    $('#dg').datagrid("reload");
                    alert(sss.Msg);
                }
            });
        }
        function setLianJie(v) {
            var rows = $('#dg').datagrid('getSelections');
            for (var i = 0; i < rows.length; i++) {//循环数组
                if (rows[i].Status == "已发货") {
                    alert("禁止对已发货订单操作!");
                    return;
                }
            }
            var s_ids = getselectedRows(0);
            var search = "";
            search = "ids=" + s_ids.join(",") + "&t=" + v;
            jQuery.ajax({
                url: "/Order/GetLianJieTrackCode/",
                type: "post",
                data: search,
                success: function (sss) {
                    if (sss.IsSuccess) {
                        alert(sss.Msg);
                        $('#dg').datagrid("reload");

                    } else {
                        alert("失败");
                    }


                }
            });
        }
        function kuai1(v) {
            $("#dg").datagrid("load", {
                BuyUnreason: 1
            });
        }
        function setUnIsDao() {
            var s_ids = getselectedRows(0);
            $.messager.confirm("提示", "确定允许撤回海外仓吗？一共是" + s_ids.length + "条订单", function (r) {
                if (r) {
                    jQuery.ajax({
                        url: "/Order/EditUnIsDao",
                        type: "post",
                        data: "o=" + s_ids.join(','),
                        success: function (res) {
                            if (res.IsError) {
                                alert(res.Message);
                            }
                            $('#dg').datagrid("reload");
                        }
                    });
                }
            });
        }
    </script>
    <input type="hidden" id="printdata" />
    <div data-options="region:'west',title:'订单类型'" style="width: 110px; padding: 10px;">
        <ul class="easyui-tree">
            <li><a href="javascript:selectlist('ALL')">所有订单</a></li>

            <li><a href="javascript:selectlist('已处理')">已处理</a></li>
            <li><a href="javascript:selectlist('待拣货')">待拣货</a></li>
            <li><a href="javascript:selectlist('待包装')">待包装</a></li>
            <li><a href="javascript:selectlist('待发货')">待发货</a></li>
            <li><a href="javascript:selectlist('已发货')">已发货</a></li>
            <li><a href="javascript:selectlist('已完成')">已完成</a></li>
            <li><a href="javascript:selectlist('退货订单')">退货订单</a></li>
            <li><a href="javascript:selectlist('缺货订单')">缺货订单</a></li>
            <li><a href="javascript:selectlist('停售订单')">停售订单</a></li>
            <li><a href="javascript:selectlist('等待审核')">等待审核</a></li>
            <li><a href="javascript:selectlist('作废订单')">作废订单</a></li>
        </ul>
    </div>
    <div data-options="region:'center'" style="height: 100%">
        <table id="dg">
            <thead>
                <tr>
                    <th field="Id" width="60" checkbox="true"></th>
                    <th field="OrderNo" width="100" formatter="GetOrder">订单编号
                    </th>
                    <th field="Status" width="100" formatter="GeStatus">订单状态
                    </th>
                    <th field="CurrencyCode" width="80" formatter="GetAmount">货币
                    </th>
                    <th field="BuyerName" width="130" formatter="GetBuyer">买家
                    </th>
                    <th field="Country" width="80">国家
                    </th>
                     <th field="Province" width="60">省
                    </th>
                    <th field="LogisticMode" width="100">发货方式
                    </th>
                    <th field="TrackCode" width="150">Code
                    </th>
                    <th field="Weight" width="80">Weight
                    </th>
                    <th field="GenerateOn" width="200" formatter="getOrderDate">时间
                    </th>
                    <th field="ScanningOn" width="200" sortable="true" formatter="getDateinfo">扫描时间
                    </th>
                    <th field="Account" width="100" formatter="getAccount">账户
                    </th>
                </tr>
            </thead>
        </table>
        <div id="toolbar">
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="$('#dlgError').dialog('open');">标记作废</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="e_order()">编辑</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="showEdit()">修改选中</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="showPrintWindow()">直接打印</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="showPrintSingleWindow()">直接打印(单品单件)</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="showPrint();">打印</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="showPrintSingle();">打印(单品单件)</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="reSend();">重新发货--仓库</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="setUnPrint();">设置为未打印</a>
            <a href="#" class="easyui-menubutton" data-options="menu:'#mm1',iconCls:'icon-redo'">导出</a>
            <div id="mm1" style="width: 150px;">
                <div data-options="iconCls:'icon-redo'" onclick="exportZM();">线下eub导出</div>
                <div data-options="iconCls:'icon-redo'" onclick="exportOrder(0);">订单导出</div>
                <div data-options="iconCls:'icon-redo'" onclick="ExportExcel(5);">导出俄速通清单</div>
                <div data-options="iconCls:'icon-redo'" onclick="ExportExcel(6);">导出北京小包清单</div>
                <div data-options="iconCls:'icon-redo'" onclick="ExportExcel(12);">导出小董仓库发货单</div>
                <div data-options="iconCls:'icon-redo'" onclick="ExportExcel(17);">导出海外仓发货清单(义乌)</div>
                <div data-options="iconCls:'icon-redo'" onclick="alert('暂时不开放');">澳大利亚导出</div>
                <div data-options="iconCls:'icon-redo'" onclick="exportOrder(1);">CDEK订单信息导出</div>
                <div data-options="iconCls:'icon-redo'" onclick="exportOrder(2);">代发货SKU导出</div>
                <div data-options="iconCls:'icon-redo'" onclick="exportOrder(3);">宁兴云导出</div>
            </div>
            <a href="#" class="easyui-menubutton" data-options="menu:'#mm2',iconCls:''">设置宁波物流</a>
            <div id="mm2" style="width: 150px;">
                <div>
                    <span>国际E邮宝</span>
                    <div>
                        <div onclick="setgjeub();">获得国际E邮宝单号</div>
                        <div onclick="getgjeubpdf();">获得国际E邮宝PDF</div>
                    </div>
                </div>

                <div class="menu-sep"></div>
                <div>
                    <span>中国邮政EMS</span>
                    <div>
                        <div onclick="seteub(0);">获得线下E邮宝单号</div>
                        @*<div onclick="seteub2(0);">获得线下E邮宝(巴西)单号</div>*@
                        <div onclick="seteub3(0);">获得线下E邮宝(南京)单号</div>
                   @*     <div onclick="seteub4(0);">获得E邮宝(联捷)单号</div>*@
                        <div onclick="seteub(2);">获得线下E特快单号</div>
                        <div onclick="geteubpdf(2);">获得线下E特快打印pdf(A4)</div>
                        <div onclick="geteubpdf(0);">获得打印pdf(10*15)</div>
                        <div onclick="geteubpdf(1);">获得打印pdf(10*10)</div>
                     @*   <div onclick="geteubpdf1(0);">(联捷)打印pdf(10*15)</div>
                        <div onclick="geteubpdf1(1);">(联捷)打印pdf(10*10)</div>*@
                        <div onclick="seteub5(0);">获得e邮宝（电子）单号</div>
                        <div onclick="geteubpdf3(0);">(e邮宝（电子）)打印pdf(10*15)</div>
                        <div onclick="geteubpdf3(1);">(e邮宝（电子）)打印pdf(10*10)</div>
                    </div>
                </div>

                <div class="menu-sep"></div>

                <div>
                    <span>速卖通线上发货</span>
                    <div>
                        <div onclick="setAliSendShow();">1.速卖通线上发货</div>
                        <div onclick="getaliTrackCode(1);">2.获得速卖通运单号</div>
                        <div onclick="getaliTrackCode(2);">1+2联合获取</div>
                         <div onclick="createWuyouOrder(1);">
                            无忧物流-标准（普货）
                        </div>
                        <div onclick="createWuyouOrder(2);">
                            无忧物流-标准（带电、化妆品）
                        </div>
                        <div onclick="getalipdf();">3.获得速卖通打印PDF</div>
                    </div>
                </div>
              
                <div class="menu-sep"></div>

                <div>
                    <span>燕文物流(宁波)</span>
                    <div>
                        <div onclick="setyw(0);">获得北京平邮单号</div>
                        <div onclick="setyw(1);">获得上海平邮单号</div>
                        <div onclick="setyw(2);">获得北京挂号单号</div>
                        <div onclick="setyw(3);">获得新加坡小包单号</div>
                        <div onclick="setyw(4);">获得中邮上海挂号小包单号</div>
                        <div onclick="setyw(5);">获得中邮宁波平邮小包</div>
                        <div onclick="setyw(7);">获得马来西亚邮政挂号小包(新)</div>
                        <div onclick="setyw(8);">获得中邮上海E邮宝(线下)单号</div>
                        <div onclick="getywpdf(1);">获得打印PDF</div>
                        <div onclick="getywpdf(1);">获得打印马来西亚PDF</div>
                        <div onclick="getywpdf2(1);">获得打印PDF(无拣货单)</div>
                    </div>
                </div>
                <div class="menu-sep"></div>
                <div onclick="GetESTTrackCode();">获得俄速通单号</div>
                <div class="menu-sep"></div>
                <div>
                    <span>出口易</span>
                    <div>
                        <div onclick="getchukouTrackcode('SGP');">出口易-新加坡小包</div>
                        <div onclick="getchukouTrackcode('EMP');">出口易-省外EMS</div>
                        <div onclick="getchukouTrackcode('NLR');">出口易-荷兰小包</div>
                        <div onclick="getchukouTrackcode('HTM');">出口易-香港小包</div>
                        <div onclick="getchukouTrackcode('MMR');">出口易-马来西亚小包</div>
                        <div onclick="getchukouTrackcode('CUE');">出口易-专线（原名美国专线）</div>
                        <div onclick="getchukouTrackcode2();">出口易-获得运单号</div>
                        <div onclick="getchukouTrackcode3();">出口易-获得打印标签</div>
                    </div>
                </div>
                <div class="menu-sep"></div>
                <div>
                    <span>比利时邮政</span>
                    <div>
                        <div onclick="setbls();">获得MiniPackEU单号</div>
                        <div onclick="getblspdf();">获得PDF</div>
                    </div>
                </div>
                <div class="menu-sep"></div>
                <div>
                    <span>欧亚速运</span>
                    <div>
                        <div onclick="getjc();">获得欧亚速运单号</div>
                         <div onclick="getjcpdf();">获得欧亚速运pdf</div>

                    </div>
                </div>
                <div class="menu-sep"></div>
                <div>
                    <span>顺邮宝</span>
                    <div>
                        <div onclick="setsub('SYBRAM');">顺邮宝挂号</div>
                        <div onclick="setsub('SYBAM');">顺邮宝平邮</div>
                        <div onclick="setsub('MYRAM');">马来挂号</div>
                        <div onclick="setsub('MYAM');">马来平邮</div>
                        @* <div onclick="getsubpdf();">获得PDF</div>*@
                    </div>
                </div>
                <div class="menu-sep"></div>
                <div>
                    <span>Wish郵</span>
                    <div>
                        <div onclick="getWishMail(0);">获得-WISH邮平邮</div>
                        <div onclick="getWishMail(1);">获得-WISH邮挂号</div>
                        <div onclick="getWishMail(2);">获得-DLP平邮</div>
                        <div onclick="getWishMail(3);">获得-DLP挂号</div>
                        <div onclick="getWishMail(4);">获得-DLE</div>
                        <div onclick="getWishMail(5);">获得-E邮宝</div>
                        <div class="menu-sep"></div>
                        <div onclick="getWishMailPdf(1);">获得PDF-A4</div>
                        <div onclick="getWishMailPdf(2);">获得PDF-4×4</div>
                    </div>
                </div>
                <div class="menu-sep"></div>
                <div>
                    <span>Lazada</span>
                    <div>
                        <div onclick="getLazada(0);">获得Lazada跟踪码</div>
                    </div>
                </div>
                <div class="menu-sep"></div>
                <div>
                    <span>上海淼信</span>
                    <div>
                        <div onclick="getMiaoxin();">获取淼信比利时邮政跟踪码</div>
                        <div onclick="getMiaoxinPDF(0);">
                            获取淼信比利时邮政pdf(10*10)
                        </div>
                        @* <div onclick="getMiaoxinPDF(1);">获取淼信比利时邮政pdf(10*12)</div>
                        <div onclick="getMiaoxinPDF(2);">获取淼信比利时邮政pdf(10*15)</div>*@
                    </div>
                </div>
               
                 <div class="menu-sep"></div>
                  <div>
                    <span>谷仓系统（宁波）</span>
                    <div>
                        <div onclick="ToGCorder(3);">订单上传谷仓</div>
                        <div onclick="GetOrderByRefCode(3);">追踪号获取</div>
                        <div onclick="GCxusend('FedEx');">FedEx单号上传</div>
                        <div onclick="GCxusend('UPS');">UPS单号上传</div>
                    </div>
                </div>
                <div class="menu-sep"></div>
                  <div>
                    <span>宁波挂号</span>
                    <div>
                        <div onclick="ToNBGHorder(1);">订单上传</div>
                        <div onclick="GetNBGH(1);">追踪号获取</div>
                    </div>
                </div>
               
            </div>
              <a href="#" class="easyui-menubutton" data-options="menu:'#mmyw',iconCls:''">设置义乌物流</a>
              <div id="mmyw" style="width: 150px;">
                <div>
                    <span>国际E邮宝</span>
                    <div>
                        <div onclick="setgjeub();">获得国际E邮宝单号</div>
                        <div onclick="getgjeubpdf();">获得国际E邮宝PDF</div>
                    </div>
                </div>

                <div class="menu-sep"></div>
                <div>
                    <span>中国邮政EMS</span>
                    <div>
                        <div onclick="seteub(0);">获得线下E邮宝单号</div>
                        @*<div onclick="seteub2(0);">获得线下E邮宝(巴西)单号</div>*@
                        <div onclick="seteub3(0);">获得线下E邮宝(南京)单号</div>
                   @*     <div onclick="seteub4(0);">获得E邮宝(联捷)单号</div>*@
                        <div onclick="seteub(2);">获得线下E特快单号</div>
                        <div onclick="geteubpdf(2);">获得线下E特快打印pdf(A4)</div>
                        <div onclick="geteubpdf(0);">获得打印pdf(10*15)</div>
                        <div onclick="geteubpdf(1);">获得打印pdf(10*10)</div>
                     @*   <div onclick="geteubpdf1(0);">(联捷)打印pdf(10*15)</div>
                        <div onclick="geteubpdf1(1);">(联捷)打印pdf(10*10)</div>*@
                        <div onclick="seteub5(0);">获得e邮宝（电子）单号</div>
                        <div onclick="geteubpdf3(0);">(e邮宝（电子）)打印pdf(10*15)</div>
                        <div onclick="geteubpdf3(1);">(e邮宝（电子）)打印pdf(10*10)</div>
                    </div>
                </div>

                <div class="menu-sep"></div>

                <div>
                    <span>速卖通线上发货</span>
                    <div>
                        <div onclick="setAliSendShow();">1.速卖通线上发货</div>
                        <div onclick="getaliTrackCode(1);">2.获得速卖通运单号</div>
                        <div onclick="getaliTrackCode(2);">1+2联合获取</div>
                         <div onclick="createWuyouOrder(1);">
                            无忧物流-标准（普货）
                        </div>
                        <div onclick="createWuyouOrder(2);">
                            无忧物流-标准（带电、化妆品）
                        </div>
                        <div onclick="getalipdf();">3.获得速卖通打印PDF</div>
                    </div>
                </div>
              
              
                <div class="menu-sep"></div>
                <div>
                    <span>CNE</span>
                    <div>

                        <div onclick="setCNE('CNE全球特惠');">获得CNE全球特惠单号</div>
                        <div onclick="setCNE('CNE全球通挂号');">获得CNE全球通挂号</div>
                        <div onclick="setCNE('CNE挂号小包');">获得CNE挂号小包</div>
                        <div onclick="setCNE('CNE全球速达');">获得CNE全球速达</div>
                        <div onclick="setCNE('CNE优速宝');">获得CNE优速宝</div>
                        <div onclick="setCNE('CNE全球快捷');">获得CNE全球快捷</div>
                        <div onclick="getcnepdf();">获得PDF</div>
                    </div>
                </div>
              
                <div class="menu-sep"></div>
                <div>
                    <span>燕文物流(义乌)</span>
                    <div>
                        <div onclick="setyw1(0);">获得北京平邮单号</div>
                        <div onclick="setyw1(1);">获得上海平邮单号</div>
                        <div onclick="setyw1(2);">获得北京挂号单号</div>
                        <div onclick="setyw1(3);">获得新加坡小包单号</div>
                        <div onclick="setyw1(6);">获得中邮杭州平邮小包单号</div>
                        <div onclick="setyw1(5);">获得中邮宁波平邮小包单号</div>
                        <div onclick="getywpdf1(1);">获得打印PDF</div>
                    </div>
                </div>
               
                <div class="menu-sep"></div>
                <div>
                    <span>八达通</span>
                    <div>
                        <div onclick="getBdt(0);">获取广州E邮宝跟踪码</div>
                        <div onclick="getBdt1(0);">恢复八达通跟踪码</div>
                        <div onclick="getBdt(1);">获取西班牙专线跟踪码</div>
                        <div onclick="getBdt(2);">获取美国专线跟踪码</div>
                        <div onclick="getBdt(3);">获取欧邮宝PG</div>
                        <div onclick="getBdt(4);">DHL挂号美国</div>
                        <div onclick="getBdt(5);">欧邮宝PP</div>
                        <div onclick="getBdt(6);">通达宝PG</div>
                        <div onclick="getBdtPDF(0);">广州E邮宝pdf(10*10)</div>
                        <div onclick="getBdtPDF(1);">西班牙专线pdf(10*10)</div>
                         <div onclick="getBdtPDF(2);">美国专线pdf(10*10)</div>
                        <div onclick="getBdtPDF(3);">欧邮宝PGpdf(10*10)</div>
                        <div onclick="getBdtPDF(4);">DHL挂号美国(10*10)</div>
                         <div onclick="getBdtPDF(5);">欧邮宝PP(10*10)</div>
                        <div onclick="getBdtPDF(6);">通达宝PG(10*10)</div>
                    </div>
                </div>
                 <div class="menu-sep"></div>
                <div>
                    <span>联捷物流</span>
                    <div>
                        <div onclick="seteub4(0);">获得E邮宝(联捷)单号</div>
                        <div onclick="seteub4(1);">获得广州E邮宝(联捷)单号</div>
                         <div onclick="setLianJie('新杭州小包');">获得新杭州小包</div>
                        <div onclick="geteubpdf1(0);">(E邮宝联)打印pdf(10*15)</div>
                        <div onclick="geteubpdf1(1);">(E邮宝联)打印pdf(10*10)</div>
                        <div onclick="geteubpdf1(2);">(广州E邮宝联)打印pdf(10*15)</div>
                        <div onclick="geteubpdf1(3);">(广州E邮宝联)打印pdf(10*10)</div>
                    </div>
                </div>
                 <div class="menu-sep"></div>
                 <div>
                    <span>义乌wish邮</span>
                    <div>
                         <div onclick="getYWWishMail(0);">获得-WISH邮平邮</div>
                        <div onclick="getYWWishMail(1);">获得-WISH邮挂号</div>
                        <div onclick="getYWWishMail(2);">获得-DLP平邮</div>
                        <div onclick="getYWWishMail(3);">获得-DLP挂号</div>
                        <div onclick="getYWWishMail(4);">获得-DLE</div>
                        <div onclick="getYWWishMail(5);">获得-E邮宝</div>
                        <div onclick="getYWWishMail(6);">获得-wish达</div>
                        <div class="menu-sep"></div>
                        <div onclick="getYWWishMailPdf(1);">获得PDF-A4</div>
                        <div onclick="getYWWishMailPdf(2);">获得PDF-4×4</div>
                    </div>
                </div>
                 <div class="menu-sep"></div>
                  <div>
                    <span>谷仓系统（义乌）</span>
                    <div>
                        <div onclick="ToGCorder(1);">订单上传谷仓</div>
                        <div onclick="GetOrderByRefCode(1);">追踪号获取</div>
                        <div onclick="GCxusend('FedEx');">FedEx单号上传</div>
                        <div onclick="GCxusend('UPS');">UPS单号上传</div>
                    </div>
                </div>
                <div class="menu-sep"></div>
                  <div>
                    <span>宁波挂号（义乌）</span>
                    <div>
                        <div onclick="ToNBGHorder(1);">订单上传</div>
                        <div onclick="GetNBGH(1);">追踪号获取</div>
                    </div>
                </div>
                <div class="menu-sep"></div>
                  <div>
                    <span>义乌邮局</span>
                    <div>
                        <div onclick="GetNBGH(2);">义乌邮局获取</div>
                         <div class="menu-sep"></div>
                       @* <div onclick="ToNBGHorder(2);">义乌挂号订单上传</div>*@
                         @*<div class="menu-sep"></div>*@
                       @* <div onclick="GetNBGH(3);">法向跟踪小包获取</div>
                         <div class="menu-sep"></div>
                        <div onclick="ToNBGHorder(3);">法向跟踪小包订单上传</div>    *@
                    </div>
                </div>
                 <div class="menu-sep"></div>
                  <div>
                    <span>苏邮系统</span>
                    <div>
                        <div onclick="ToGCorder(2);">订单上传苏邮</div>
                        <div onclick="GetOrderByRefCode(2);">追踪号获取</div>
                    @*    <div onclick="GCxusend('FedEx');">FedEx单号上传</div>
                        <div onclick="GCxusend('UPS');">UPS单号上传</div>*@
                    </div>
                </div>
                   <div class="menu-sep"></div>
                  <div>
                    <span>汇鑫物流</span>
                    <div>
                       <div onclick="seteub4(2);">获得E邮宝(汇鑫)单号</div>
                      @*  <div onclick="seteub4(3);">获得E邮宝(汇鑫)单号(上海)</div>*@
                        <div onclick="geteubpdf1(4);">(E邮宝汇鑫)打印pdf(10*15)</div>
                        <div onclick="geteubpdf1(5);">(E邮宝汇鑫)打印pdf(10*10)</div>
                    </div>
                </div>
            </div>

            @*<a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="exportZM();">中美导出</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="exportOrder();">订单导出</a>*@
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="o_ReError()">失效订单修正</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="o_ReQue()">缺货订单修正</a>
            @*<a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="o_SplitZu()">分割组合产品</a>*@
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="$('#l_dlg').dialog('open');">拦截</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="dispute()">添加纠纷</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="oneKeySplitOrder()">一键拆包</a>
            @*<a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="xuSend();">虚假发货</a>*@
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="xuSend();">单号上传</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="setstatus();">已发货标记</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="updateOrders();">批量修改</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="auditOders();">批量审批超时未发货订单</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" title="此处单号取自【邮政编码】" onclick="GetTradeno();">手动单号获取</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="CalculateQue();">缺货计算</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="setUnIsDao();">同意海外仓撤回</a>
            <br />
            平台<input type="text" id="Platform" />
            账户<input type="text" id="Account" />
            状态<input type="text" id="OrderStatus" />
            打印状态:<input type="text" id="IsPrint" />
            缺货:<input type="text" id="IsQue" />
            虚发:<input type="text" id="IsXu" />
            拆包:<input type="text" id="IsChai" />
            重发:<input type="text" id="IsChong" /><br />
            拦截:<input type="text" id="IsError" />
            留言:<input type="text" id="IsLiu" />
            可拆:<input type="text" id="IsCanSplit" />
            特性:<input type='text' name='ProductAttribute' id='ProductAttribute' />
            FBA:<input type='text' name='IsFba' id='IsFba' />
            FBA仓库:<input type='text' name='FBABy' id='FBABy' />
            时间类型:<input type="text" id="orderdateType" />
            开始：<input type="text" id="CreateOn_st" class="easyui-datetimebox" style="width: 150px" />
            结束：<input type="text" id="CreateOn_et" class="easyui-datetimebox" style="width: 150px" />
            异常订单选择:<input type="text" id="IsNo" />
            订单类型<input type="text" id="OrderPdtType" />
            地区:<input type="text" id="area" />
            <input id="txtSearch" class="easyui-searchbox" data-options="prompt:'查询关键字',searcher:doSearch,menu:'#mm'"></input>
            <input id="txtSearch1" class="easyui-searchbox" data-options="prompt:'查询关键字',searcher:doSearch,menu:'#mmm'"></input><br />
            快捷查询：
            <img src='/Content/imgs/Print.gif'>
            <a href="#" onclick="kuai(1)">打印</a>
            <img src='/Content/imgs/Merger.gif'><a href="#" onclick="kuai(2)">合并</a>
            <img src='/Content/imgs/Split.gif'><a href="#" onclick="kuai(3)">拆分</a>
            <img src='/Content/imgs/OutOfStock.gif'><a href="#" onclick="kuai(4)">缺货</a>
            <img src='/Content/imgs/Repeat.gif'><a href="#" onclick="kuai(5)">重发</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="kuai1(1)">黑名单</a>
        </div>
        <div id="mm" style="width: 120px">
            <div data-options="name:'OrderNo'">订单编号</div>
            <div data-options="name:'OrderExNo'">外部编号</div>
            <div data-options="name:'TId'">流水交易号</div>
            <div data-options="name:'SKU_OrderProduct'">SKU</div>
            <div data-options="name:'BuyerName'">买家</div>
            <div data-options="name:'BuyerEmail'">买家邮箱</div>
            <div data-options="name:'Amount_si'">金额大于</div>
            <div data-options="name:'Amount_ei'">金额小于</div>
            <div data-options="name:'LogisticMode'">发货方式</div>
            <div data-options="name:'TrackCode'">追踪号</div>
            <div data-options="name:'Country'">国家</div>
            <div data-options="name:'ScanningBy'">扫描人</div>
            <div data-options="name:'Addressee_OrderAddress'">收件人</div>
        </div>
        <div id="mmm" style="width: 120px">
            <div data-options="name:'OrderNo'">订单编号</div>
            <div data-options="name:'OrderExNo'">外部编号</div>
            <div data-options="name:'TId'">流水交易号</div>
            <div data-options="name:'SKU_OrderProduct'">SKU</div>
            <div data-options="name:'BuyerName'">买家</div>
            <div data-options="name:'BuyerEmail'">买家邮箱</div>
            <div data-options="name:'Amount_si'">金额大于</div>
            <div data-options="name:'Amount_ei'">金额小于</div>
            <div data-options="name:'LogisticMode'">发货方式</div>
            <div data-options="name:'TrackCode'">追踪号</div>
            <div data-options="name:'Country'">国家</div>
            <div data-options="name:'ScanningBy'">扫描人</div>
            <div data-options="name:'Addressee_OrderAddress'">收件人</div>
        </div>
        <div id="c_dlg"></div>
        <div id="c1_dlg"></div>
        <div id="e_dlg"></div>
        <div id="o_dlg"></div>
        <div id="s_dlg" style="display: none">
            <table>
                <tr>
                    <td>替换方式
                    </td>
                    <td>
                        <select id="tt" style="width: 200px;">
                            <option value="OrderNo">系统单号</option>
                            <option value="OrderExNo">平台单号</option>
                            <option value="TrackCode">跟踪码</option>
                            <option value="TId">交易流水号</option>
                        </select>
                    </td>

                </tr>

                <tr>
                    <td>替换信息</td>
                    <td>
                        <select id="cc" style="width: 200px;">
                            <option value="Country">国家</option>
                            <option value="CurrencyCode">货币</option>
                            <option value="SKU">SKU</option>
                            <option value="LogisticMode">运输方式</option>
                            <option value="OrderStatusinput">状态</option>
                        </select>
                    </td>

                </tr>
                <tr>

                    <td>替换值</td>




                    <td>
                        <input type="text" id="txtNew" /></td>
                </tr>
                <tr>
                    <td>输入项</td>
                    <td>
                        <textarea id="txtOrderNo" rows="15" cols="30"></textarea></td>
                </tr>
                <tr>
                    <td>导出</td>
                    <td><a href="#" class="easyui-linkbutton" iconcls="icon-print" plain="true" id="btnOrderExport" onclick="exportOrderinput();">订单导出</a></td>
                </tr>
            </table>
        </div>

        <div id="l_dlg" class="easyui-dialog" title="订单拦截设置" style="width: 400px; height: 250px; padding: 10px" closed="true">
            <table>
                <tr>
                    <td>原因:</td>
                    <td>
                        <input type="text" id="HoldUpType" /></td>
                </tr>
                <tr>
                    <td>描述</td>
                    <td>
                        <textarea id="HoldUpDesc" style="width: 300px;"></textarea></td>
                </tr>
                <tr>
                    <td>产品设置:</td>
                    <td>
                        <select id="CReHoldUp" style="width: 200px;">
                            <option value="0">不操作</option>
                            <option value="1">重置入库</option>
                        </select></td>
                </tr>

                <tr>
                    <td></td>
                    <td>
                        <input type="button" value="确定" onclick="o_LanJie()" /></td>
                </tr>
            </table>
        </div>
        <div id="dlgError" class="easyui-dialog" title="作废订单" style="width: 400px; height: 250px; padding: 10px" closed="true">
            <table>
                <tr>
                    <td>原因:</td>
                    <td>
                        <input type="text" id="ErrorType" /></td>
                </tr>
                <tr>
                    <td>描述</td>
                    <td>
                        <textarea id="ErrorDesc" style="width: 300px;"></textarea></td>
                </tr>
                <tr>
                    <td></td>
                    <td>
                        <input type="button" value="确定" onclick="o_Error()" /></td>
                </tr>
            </table>
        </div>

        <div id="dlgAliSend" class="easyui-dialog" title="速卖通发货" style="width: 400px; height: 250px; padding: 10px" closed="true">
            <table>
                <tr>
                    <td>订单号:</td>
                    <td>
                        <input type="text" id="txtAliOrderNo" /></td>
                </tr>
                <tr>
                    <td>物流方式:</td>
                    <td>
                        <input type="text" id="aliWarehouseCarrierService" /></td>
                </tr>

                <tr>
                    <td></td>
                    <td>
                        <input type="button" value="确定" onclick="setAliSend()" /></td>
                </tr>
            </table>
        </div>
    </div>
</body>
